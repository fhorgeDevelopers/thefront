(()=>{
    function e(e, t) {
        var a = e.split("?");
        if (a.length >= 2) {
            for (var n = encodeURIComponent(t) + "=", l = a[1].split(/[&;]/g), i = l.length; i-- > 0; )
                (-1 !== l[i].lastIndexOf(n, 0) || void 0 !== l[i][0] && l[i][0].indexOf(",") > -1) && l.splice(i, 1);
            return e = a[0] + "?" + (l.length > 0 ? "" + l.join("&") : "")
        }
        return e
    }
    function t(e, t, a, n) {
        for (var l = this, i = 0; i < e.length; i++)
            if (void 0 !== e[i].name) {
                var r = (new CourseCard).buildCourseItem(e[i], "white", !0);
                $(t).find(".blank:not(.ad)").first().parent().replaceWith(r);
                var o = $(r).next().find(".ad");
                $(r).next().find(".ad").length > 0 && (o.removeClass("blank"),
                "default" === n.categoryAd.adType && (adsbygoogle = window.adsbygoogle || []).push({}))
            }
        0 === $(".search-results-wrapper--index").length && $.each($(".leaderboard:visible, .search-ad-mobile:visible"), (function() {
            setTimeout((function() {
                (adsbygoogle = window.adsbygoogle || []).push({})
            }
            ), 700)
        }
        )),
        $(".blank").parent().remove(),
        ".related-search-list" !== t && function(e) {
            var t, a = $('script[async="true"][type="application/ld+json"]'), n = [];
            if (e.length > 0)
                for (var l = 0; l < e.length; l++)
                    n.push({
                        "@type": "ListItem",
                        position: l + 1,
                        url: "https://alison.com/course/" + e[l].slug
                    });
            if (t = JSON.stringify({
                "@context": "http://schema.org",
                "@type": "ItemList",
                itemListElement: n
            }),
            0 === a.length) {
                var i = document.createElement("script");
                return i.type = "application/ld+json",
                i.async = "true",
                i.text = t,
                void $("head").append(i)
            }
            a.text(t)
        }(e),
        !0 === n.categoryAd.active && $(".ad.course-block").each((function(e) {
            var t = n.categoryAd.adType;
            $(l).html(createGoogleAd("fluid", n[t]["inline-" + e], "-6t+ed+2i-1n-4w"))
        }
        )),
        void 0 !== a && a && dataLayer.push({
            event: "optimize.activate"
        })
    }
    function a(e) {
        var t = 6
          , a = document.createElement("ul")
          , n = ["3285035941", "4311957408", "6335485514", "5960791435", "3242418311"]
          , l = 0;
        if ($(".fullwidth-search").length > 0 && $(window).width() >= 1897 && (t = 5),
        a.innerHTML = e,
        "" !== $("#search").attr("data-ads-enabled"))
            for (var i = 1; i <= a.childNodes.length; i++) {
                if (!($(".fullwidth-search").length > 0 && $(window).width() >= 1897 && 4 === l && 0 === $(".certs-diploma").length))
                    if (i % t == 0) {
                        var r = '<div class="ad course-block blank match-height" style=""><div><ins class="adsbygoogle" style="display:block" data-ad-format="fluid" data-ad-layout="image-top" data-ad-client="ca-pub-4877892089121284" data-ad-slot="' + n[l] + '"></ins></div></div>';
                        a.childNodes[i - 1].outerHTML = "<li>" + r + "</li>" + a.childNodes[i - 1].outerHTML,
                        l++,
                        $(".certs-diploma").length > 0 && (l = 0)
                    }
            }
        return a
    }
    function n(e, t, a) {
        var n;
        a = null !== (n = a) && void 0 !== n ? n : 1,
        e = parseInt((e + "").split("&")[0]);
        var l = parseInt(t > e ? e : t)
          , i = (parseInt(a) - 1) * e
          , r = i + 1 + " - " + (i + parseInt(e));
        if (1 === parseInt(a))
            return $(".index-title").html(defaultTitle),
            void $(".top-category-count").text(l);
        $(".index-title").html($(".index-title").attr("data-cat") + " " + r)
    }
    window.returnURLParameter = function(e, t, a) {
        var n = t;
        return (void 0 === a ? window.location.href : a).replace(/[?&]+([^=&]+)=([^&]*)/gi, (function(t, a, l) {
            a === e && (n = l)
        }
        )),
        n
    }
    ,
    window.genPageNum = function(t, a, n, l) {
        var i = e(window.location.href, "page");
        i += -1 !== i.indexOf("?") ? (-1 !== i.indexOf("=") ? "&" : "") + "page=" : "?page=",
        $(".js-pagination").pagination({
            items: a,
            itemsOnPage: t || 20,
            pages: Math.ceil(a / t),
            cssStyle: "light-theme",
            currentPage: n,
            hrefTextPrefix: i,
            onPageClick: function(e, t) {
                t.preventDefault(),
                l(e)
            }
        })
    }
    ,
    window.showResult = function(e, n) {
        void 0 === n && (n = {
            categoryAd: {
                adType: "default",
                active: !1
            }
        });
        var l = e.total < 6
          , i = new CourseCard;
        if (0 === $(".blank:not(.ad)").length && 0 !== e.total || $(".fullwidth-search").length > 0) {
            var r = $(".fullwidth-search").attr("data-amount") || 20
              , o = a(i.createBlanks(r));
            $(".course-listing").html(o.innerHTML)
        }
        if (0 !== e.total && t(e.result, ".course-listing", !l, n),
        void 0 !== e.related && e.total < 6) {
            var s = a(i.createBlanks(30));
            $(".related-search-list").html(s.innerHTML).parent().show(),
            t(e.related, ".related-search-list", l, n)
        } else
            $(".related-search").hide().find(".related-search-list").html("")
    }
    ,
    window.createGoogleAd = function(e, t, a) {
        var n = '<ins class="adsbygoogle"style="display:block"data-ad-client="ca-pub-4877892089121284"data-ad-slot="' + t + '"data-ad-format="' + e + '"';
        return void 0 !== a && (n += ' data-ad-layout-key="' + a + '"'),
        n += ' data-full-width-responsive="true"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});<\/script>'
    }
    ;
    var l = "";
    function i(t, a, l, r) {
        var o = this;
        void 0 === r && (r = null);
        var s = $(".filter-order select").val()
          , d = void 0 !== $(".filter-type select").val() ? $(".filter-type select").val() : ""
          , c = $(".filter-lang select").val()
          , g = $("#search").attr("data-endpoint") + "/search?locale=" + language + "&language=" + c + "&order=" + s + "&" + a + "&page=" + t;
        a.indexOf("type=certificate") > -1 || a.indexOf("type=diploma") > -1 ? ($(".filter-type").hide(),
        $(".filter-lang").removeClass("wide")) : a.indexOf("category=") > -1 && (g += "default" === d ? "" : "&type=" + d),
        $.ajax({
            url: g + "&include_summary=1",
            type: "GET",
            contentType: "application/json",
            success: function(s) {
                if (s.total > 0) {
                    l(s),
                    $(".no-results").hide(),
                    (void 0 !== s.aggregations || $(".lp-active").length < 1) && (window.api_languages = s.aggregations.language,
                    window.selected = r);
                    var d = a.split("size=")[1] || 20;
                    if (window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi, (function(e, t, a) {
                        "size" === t && (d = a)
                    }
                    )),
                    genPageNum(d, s.total, t, (function(t) {
                        page = t,
                        $(window).scrollTop($(".category-meta").offset().top + $(".category-meta").height());
                        var l = "Free Online Diploma and Certificate Level Training Courses | Alison"
                          , r = e(window.location.href, "page");
                        -1 !== r.indexOf("?") ? r += (-1 !== r.indexOf("=") ? "&" : "") + "page=" + t : r = "?page=" + t,
                        window.history.pushState({}, l, r),
                        document.title = l,
                        i(t, a, (function(e) {
                            showResult(e),
                            n(d, e.result.length, t)
                        }
                        ))
                    }
                    )),
                    window.location.search) {
                        window.location.href.split("?")[0],
                        window.location.search;
                        var c = []
                          , g = $("head title").text().split("|")[0] + ("| Page " + window.location.search.split("=")[1]) + " | Alison";
                        return $("head title").text(g),
                        $("head link[rel=alternate]").each((function(e) {
                            c.push({
                                href: $(o).attr("href"),
                                hreflang: $(o).attr("hreflang")
                            })
                        }
                        )),
                        c.forEach((function(e) {
                            $("head link[rel=alternate][hreflang=" + e.hreflang + "]").attr("href", e.href + window.location.search)
                        }
                        )),
                        void $("head link[rel=alternate]").each((function(e) {
                            console.debug($(o).attr("href"), $(o).attr("hreflang"))
                        }
                        ))
                    }
                } else
                    (void 0 !== s.aggregations || $(".lp-active").length < 1) && (window.api_languages = s.aggregations.language,
                    window.selected = r),
                    $(".index-title").text("Sorry, we found no results for your search"),
                    $(".no-results").show(),
                    $(".course-listing").html(""),
                    $(".simple-pagination").hide("")
            }
        })
    }
    function r(e) {
        $.ajax({
            type: "get",
            url: $("#search").attr("data-endpoint") + "/language/list",
            dataType: "json",
            async: !1,
            success: function(t) {
                languages = t.result,
                e && (populateLanguageDropdown(window.api_languages, window.selected),
                $(".loading").fadeOut())
            },
            error: function(e) {
                console.log(e),
                console.warn("error fetching languages list", e)
            }
        })
    }
    function o(e, t) {
        return function(a, n) {
            var l, i = null, r = 0;
            return "key" === e && ("duration" !== t ? (l = a.key.toUpperCase(),
            i = n.key.toUpperCase()) : (l = parseInt(a.key.replace("+", "").split("-")[0]),
            i = parseInt(n.key.replace("+", "").split("-")[0]))),
            "name" === e && (l = a.name.toUpperCase(),
            i = n.name.toUpperCase()),
            "key-numeric" === e && (l = a.key,
            i = n.key),
            "value-numeric" === e && (l = n.value,
            i = a.value),
            "selected" === e && (l = n.selected,
            i = a.selected),
            l > i ? r = 1 : l < i && (r = -1),
            r
        }
    }
    window.initCatSearch = function(e, t) {
        var a = this;
        void 0 === $("#search").attr("data-param") && ($("#search").attr("data-param", e),
        $('[name="type-sorting"], [name="sorting"], [name="lang-sorting"]').change((function() {
            t = 1,
            "lang-sorting" === $(a)[0].name && (l = $(a).prop("selectedIndex") > 0 ? $(a).children("option:selected").val() : ""),
            initCatSearch($("#search").attr("data-param"), t)
        }
        ))),
        i(t, e, (function(a) {
            var l = e.split("size=")[1] || 20;
            showResult(a),
            void 0 === a.result || n(l, a.result.length, t)
        }
        ), l)
    }
    ,
    window.api_languages = "",
    window.selected = "",
    window.languages = null,
    $(document).on("click", "select[name=lang-sorting]:not(.loaded)", (function(e) {
        e.preventDefault(),
        $(".loading").fadeIn(),
        $(this).hasClass(".loaded") || ($(this).addClass("loaded"),
        r(!0)),
        $("select[name=lang-sorting]").trigger("click")
    }
    )),
    $(".search-index").length > 0 && r(!1),
    window.populateLanguageDropdown = function(e, t) {
        if (void 0 !== e && 0 != e.length) {
            $(".filter-lang select").find("option:gt(0)").remove(),
            t || ($(".filter-lang select option").removeAttr("selected"),
            $(".filter-lang select option:nth(0)").attr("selected", "selected"));
            for (var a = 0; a < e.length; a++)
                for (var n = 0; n < languages.length; n++)
                    e[a].key == languages[n].code && (e[a].name = languages[n].defaultName);
            e = customSorter(e, "language"),
            $.each(e, (function(e, a) {
                a.key == t ? $(".filter-lang select").append($("<option>", {
                    value: a.key,
                    text: a.name + " (" + a.value + ")",
                    selected: !0
                })) : $(".filter-lang select").append($("<option>", {
                    value: a.key,
                    text: a.name + " (" + a.value + ")"
                }))
            }
            ))
        } else
            $(".filter-lang").hide()
    }
    ,
    window.customSorter = function(e, t) {
        switch (t) {
        case "course_type" === t:
            e.sort(o("name", t));
            break;
        case "duration" === t:
            e.sort(o("key", t));
            break;
        case "course_level" === t:
            e.sort(o("key-numeric", t));
            break;
        case "category" === t:
            e.sort(o("selected", t));
            break;
        case "tag" === t:
            e.sort(o("value-numeric", t)),
            e.sort(o("selected", t));
            break;
        case "language" === t:
            var a = null;
            e.sort(o("name", t)),
            e.sort(o("selected", t));
            for (var n = 0; n < e.length; n++)
                "en" === e[n].key && (a = e.splice(n, 1));
            null != a && (e = a.concat(e))
        }
        return e
    }
    ,
    Handlebars.registerHelper("encodeChars", (function(e) {
        return encodeURIComponent(e)
    }
    ))
}
)();
